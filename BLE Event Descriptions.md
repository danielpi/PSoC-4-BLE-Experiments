# BLE Events

**CYBLE\_EVT\_HOST\_INVALID**##Range for Generic events - 0x01 to 0x1F**CYBLE\_EVT\_STACK\_ON** This event is received when BLE stack is initialized and turned ON by invoking CyBle\\_StackInit() function.    **CYBLE\_EVT\_TIMEOUT** This event is received when there is a timeout and application needs to handle the event. Timeout reason is defined by CYBLE\_TO\_REASON\_CODE\_T.**CYBLE\_EVT\_HARDWARE\_ERROR** This event indicates that some internal hardware error has occurred. Reset of the hardware may be required.**CYBLE\_EVT\_HCI\_STATUS** This event is triggered by 'Host Stack' if 'Controller' responds with an error code for any HCI command. Event parameter returned will be an HCI error code as defined in Bluetooth 4.1 core specification, Volume 2, Part D, section 1.3. This event will be received only if there is an error.**CYBLE\_EVT\_STACK\_BUSY\_STATUS** This event is triggered by the host stack if BLE stack is busy or not. Event Parameter corresponding to this event will indicate the state of BLE stack's internal protocol buffers for the application to safely initiate data transactions (GATT, GAP Security, and L2CAP transactions) with the peer BLE device.## Range for GAP events - 0x20 to 0x3F**CYBLE\_EVT\_GAPC\_SCAN\_PROGRESS\_RESULT** This event is triggered every time a device is discovered; pointer to structure of type CYBLE\_GAPC\_ADV\_REPORT\_T is returned as the event parameter.**CYBLE\_EVT\_GAP\_AUTH\_REQ** This event is received by Peripheral and Central devices. When it is received by Peripheral, peripheral needs to Call CyBle\_GappAuthReqReply() to reply to authentication request from Central. When this event is received by Central, that means the slave has requested Central to initiate authentication procedure. Central needs to call CyBle\_GappAuthReq() to initiate authentication procedure. Pointer to structure of type CYBLE\_GAP\_AUTH\_INFO\_T is returned as the event parameter.**CYBLE\_EVT\_GAP\_PASSKEY\_ENTRY\_REQUEST** This event indicates that the device has to send passkey to be used during the pairing procedure. CyBle\_GapAuthPassKeyReply() is required to be called with valid parameters on receiving this event. Refer to Bluetooth Core Spec. 4.1, Part H, Section 2.3.5.1 Selecting STK Generation Method. Nothing is returned as part of the event parameter.**CYBLE\_EVT\_GAP\_PASSKEY\_DISPLAY\_REQUEST** This event indicates that the device needs to display passkey during the pairing procedure. Refer to Bluetooth Core Spec. 4.1, Part H, Section 2.3.5.1 Selecting STK Generation Method. Pointer to data of type 'uint32' is returned as part of the event parameter. Passkey can be any 6-decimal-digit value.**CYBLE\_EVT\_GAP\_AUTH\_COMPLETE** This event indicates that the authentication procedure has been completed. The event parameter contains the security information as defined by CYBLE\_GAP\_AUTH\_INFO\_T. This event is generated at the end of the following three operations:* Authentication is initiated with a newly connected device* Encryption is initiated with a connected device that is already bonded* Re-Encryption is initiated with a connected device with link already encryptedDuring encryption/re-encryption, the Encryption Information exchanged during the pairing process is used to encrypt/re-encrypt the link. As this does not modify any of the authentication  parameters with which the devices were paired, this event is generated with NULL event data and the result of the encryption operation.**CYBLE\_EVT\_GAP\_AUTH\_FAILED** Authentication process failed between two devices. The return value of type  CYBLE\_GAP\_AUTH\_FAILED\_REASON\_T indicates the reason for failure.**CYBLE\_EVT\_GAPP\_ADVERTISEMENT\_START\_STOP** Peripheral device has started/stopped advertising. This event is generated after making a call to CyBle\_GappEnterDiscoveryMode and CyBle\_GappExitDiscoveryMode functions. The event parameter contains the status which is of type 'uint8'. If the data is '0x00', it indicates 'success'; Anything else indicates 'failure'. 
**CYBLE\_EVT\_GAP\_DEVICE\_CONNECTED** This event is generated at the GAP Peripheral end after connection is completed with peer Central device. For GAP Central device, this event is generated as in acknowledgment of receiving this event successfully by BLE Controller. Once connection is done, no more event is required but if fails to establish connection, 'CYBLE\_EVT\_GAP\_DEVICE\_DISCONNECTED' is passed to application. Event parameter is a pointer to a structure of type CYBLE\_GAP\_CONN\_PARAM\_UPDATED\_IN\_CONTROLLER\_T.**CYBLE\_EVT\_GAP\_DEVICE\_DISCONNECTED** Disconnected from remote device or failed to establish connection. Parameter returned with the event contains pointer to the the reason for disconnection, which is of type uint8. For details refer core spec 4.2, vol2, part D 
**CYBLE\_EVT\_GAP\_ENCRYPT\_CHANGE** Encryption change event for active connection. 'evParam' can be decoded as* evParam[0] = 0x00 -> Encryption OFF* evParam[0] = 0x01 -> Encryption ON* Any other value of evParam[0] -> Error     This is an informative event for application when there is a change in encryption. Application may choose to ignore it.**CYBLE\_EVT\_GAP\_CONNECTION\_UPDATE\_COMPLETE** This event is generated at the GAP Central and the Peripheral end after connection parameter update is requested from the host to the controller. Event parameter is a pointer to a structure of type CYBLE\_GAP\_CONN\_PARAM\_UPDATED\_IN\_CONTROLLER\_T.**CYBLE\_EVT\_GAPC\_SCAN\_START\_STOP** Central device has started/stopped scanning. This event is generated after making a call to CyBle\_GapcStartDiscovery and CyBle\_GapcStopDiscovery APIs. The event parameter contains the status, which is of type 'uint8'. If the data is '0x00', it indicates 'success'; Anything else indicates 'failure'.**CYBLE\_EVT\_GAP\_KEYINFO\_EXCHNGE\_CMPLT** Indication that the SMP keys exchange with peer device is complete, the event handler is expected to store the peer device keys, especially IRK which is used to resolve the peer device after the connection establishment. Event parameter returns data of type CYBLE\_GAP\_SMP\_KEY\_DIST\_T containing the peer device keys.##Range for GATT events - 0x40 to 6F**CYBLE\_EVT\_GATTC\_ERROR\_RSP** The event is received by the Client when the Server cannot perform the requested operation and sends out an error response. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_ERR\_RSP\_PARAM\_T.**CYBLE\_EVT\_GATT\_CONNECT\_IND** This event is generated at the GAP Peripheral end after connection is completed with peer Central device. For GAP Central device, this event is generated as in acknowledgment of receiving this event successfully by BLE Controller. Once connection is done, no more event is required but if fails to establish connection, 'CYBLE\_EVT\_GATT\_DISCONNECT\_IND' is passed to application. Event parameter is a pointer to a structure of type CYBLE\_GAP\_CONN\_PARAM\_UPDATED\_IN\_CONTROLLER\_T.**CYBLE\_EVT\_GATT\_DISCONNECT\_IND** GATT is disconnected. Nothing is returned as part of the event parameter.**CYBLE\_EVT\_GATTS\_XCNHG\_MTU\_REQ** 'MTU Exchange Request' received from GATT client device. Event parameter contains the MTU size of type CYBLE\_GATT\_XCHG\_MTU\_PARAM\_T.**CYBLE\_EVT\_GATTC\_XCHNG\_MTU\_RSP** 'MTU Exchange Response' received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATT\_XCHG\_MTU\_PARAM\_T.**CYBLE\_EVT\_GATTC\_READ\_BY\_GROUP\_TYPE\_RSP** 'Read by Group Type Response' received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_READ\_BY\_GRP\_RSP\_PARAM\_T.**CYBLE\_EVT\_GATTC\_READ\_BY\_TYPE\_RSP** 'Read by Type Response' received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_READ\_BY\_TYPE\_RSP\_PARAM\_T. **CYBLE\_EVT\_GATTC\_FIND\_INFO\_RSP** 'Find Information Response' received from server device. Event parameter is a pointer to a structure of type 'CYBLE\_GATTC\_FIND\_INFO\_RSP\_PARAM\_T. **CYBLE\_EVT\_GATTC\_FIND\_BY\_TYPE\_VALUE\_RSP** 'Find by Type Value Response' received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_FIND\_BY\_TYPE\_RSP\_PARAM\_T. **CYBLE\_EVT\_GATTC\_READ\_RSP** 'Read Response' from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_READ\_RSP\_PARAM\_T. **CYBLE\_EVT\_GATTC\_READ\_BLOB\_RSP** 'Read Blob Response' from server. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_READ\_RSP\_PARAM\_T. **CYBLE\_EVT\_GATTC\_READ\_MULTI\_RSP** 'Read Multiple Responses' from server. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_READ\_RSP\_PARAM\_T. The 'actualLen' field should be ignored as it is unused in this event response. **CYBLE\_EVT\_GATTS\_WRITE\_REQ** 'Write Request' from client device. Event parameter is a pointer to a structure of type CYBLE\_GATTS\_WRITE\_REQ\_PARAM\_T . **CYBLE\_EVT\_GATTC\_WRITE\_RSP** 'Write Response' from server device. Event parameter is a pointer to a structure of type CYBLE\_CONN\_HANDLE\_T. **CYBLE\_EVT\_GATTS\_WRITE\_CMD\_REQ** 'Write Command' Request from client device. Event parameter is a pointer to a structure of type CYBLE\_GATTS\_WRITE\_CMD\_REQ\_PARAM\_T. **CYBLE\_EVT\_GATTS\_PREP\_WRITE\_REQ** 'Prepare Write' Request from client device. Event parameter is a pointer to a structure of type CYBLE\_GATTS\_PREP\_WRITE\_REQ\_PARAM\_T. 
**CYBLE\_EVT\_GATTS\_EXEC\_WRITE\_REQ** 'Execute Write' request from client device. Event parameter is a pointer to a structure of type 'CYBLE\_GATTS\_EXEC\_WRITE\_REQ\_T' This event will be triggered before GATT DB is modified. GATT Db will be updated only if there is no error condition provided by application. Incase of error condition triggered during stack validation, partial write will occur. Write will be cancelled from that handle where error has occured and error response corresponding to that handle will be sent to remote. If at any point of time 'CYBLE\_GATT\_EXECUTE\_WRITE\_CANCEL\_FLAG' is received in execWriteFlag fields of 'CYBLE\_GATTS\_EXEC\_WRITE\_REQ\_T' structure, then all previous writes are cancelled. For execute cancel scenerio, all elements of 'CYBLE\_GATTS\_EXEC\_WRITE\_REQ\_T' should be ignored except execWriteFlag and connHandle.**CYBLE\_EVT\_GATTC\_EXEC\_WRITE\_RSP** 'Execute Write' response from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_EXEC\_WRITE\_RSP\_T. **CYBLE\_EVT\_GATTC\_HANDLE\_VALUE\_NTF** Notification data received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_HANDLE\_VALUE\_NTF\_PARAM\_T. **CYBLE\_EVT\_GATTC\_HANDLE\_VALUE\_IND** Indication data received from server device. Event parameter is a pointer to a structure of type CYBLE\_GATTC\_HANDLE\_VALUE\_IND\_PARAM\_T. **CYBLE\_EVT\_GATTS\_HANDLE\_VALUE\_CNF** Confirmation to indication response from client device. Event parameter is a pointer to a structure of type CYBLE\_CONN\_HANDLE\_T. **CYBLE\_EVT\_GATTS\_DATA\_SIGNED\_CMD\_REQ** Confirmation to indication response from client device. Event parameter is a pointer to a structure of type CYBLE\_GATTS\_SIGNED\_WRITE\_CMD\_REQ\_PARAM\_T. if value.val parameter is set to Zero, then signature is not matched and ignored by stack **CYBLE\_EVT\_GATTC\_STOP\_CMD\_COMPLETE** Event indicating that GATT group procedure has stopped or completed, this event occurs only if application has called CyBle\_GattcStopCmd API. Event parameters shall be ignored **CYBLE\_EVT\_GATTS\_READ\_CHAR\_VAL\_ACCESS\_REQ** Event parameters for characteristic read value access event generated by BLE Stack upon an access of Characteristic value read for the characteristic definition which has CYBLE\_GATT\_DB\_ATTR\_CHAR\_VAL\_RD\_EVENT property set. ##Range for L2AP events - 0x70 to 0x7F**CYBLE\_EVT\_L2CAP\_CONN\_PARAM\_UPDATE\_REQ** This event indicates the connection parameter update received from the remote device. The application is expected to reply to L2CAP using the CyBle\_L2capLeConnectionParamUpdateResponse() function to respond to the remote device, whether parameters are accepted or rejected. Event Parameter pointer points to data of type 'CYBLE\_GAP\_CONN\_UPDATE\_PARAM\_T'**CYBLE\_EVT\_L2CAP\_CONN\_PARAM\_UPDATE\_RSP** This event indicates the connection parameter update response received from the master. Event Parameter pointer points to data with two possible values:* Accepted = 0x0000* Rejected  = 0x0001Data is of type unit16. **CYBLE\_EVT\_L2CAP\_COMMAND\_REJ** This event indicates that the request send over l2cap signalling has been rejected. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_COMMAND\_REJ\_REASON\_T. **CYBLE\_EVT\_L2CAP\_CBFC\_CONN\_IND** This event is used to inform application of the incoming L2CAP CBFC Connection Request. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_CONN\_IND\_PARAM\_T is returned. **CYBLE\_EVT\_L2CAP\_CBFC\_CONN\_CNF** This event is used to inform application of the L2CAP CBFC Connection Response/Confirmation. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_CONN\_CNF\_PARAM\_T is returned. **CYBLE\_EVT\_L2CAP\_CBFC\_DISCONN\_IND** This event is used to inform application of the L2CAP CBFC Disconnection Request received from the Peer device. Event parameter is a pointer to Local CID of type unit16. **CYBLE\_EVT\_L2CAP\_CBFC\_DISCONN\_CNF** This event is used to inform application of the L2CAP CBFC Disconnection confirmation/Response received from the Peer device. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_DISCONN\_CNF\_PARAM\_T. **CYBLE\_EVT\_L2CAP\_CBFC\_DATA\_READ** This event is used to inform application of data received over L2CAP CBFC channel. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_RX\_PARAM\_T. **CYBLE\_EVT\_L2CAP\_CBFC\_RX\_CREDIT\_IND** This event is used to inform the application of receive credits reached low mark. After receiving L2CAP data/payload from peer device for a specification Channel, the available credits are calculated. If the credit count goes below the low mark, this event is called to inform the application of the condition, so that if the application wantsm it can send more credits to the peer device. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_LOW\_RX\_CREDIT\_PARAM\_T. **CYBLE\_EVT\_L2CAP\_CBFC\_TX\_CREDIT\_IND** This event is used to inform application of having received transmit credits. This event is called on receiving LE Flow Control Credit from peer device. Event parameter is a pointer to a structure of type CYBLE\_L2CAP\_CBFC\_LOW\_TX\_CREDIT\_PARAM\_T. If the 'result' field of the received data is non-zero, this indicates an error. If the sum of 'credit' field value and the previously available credit at the peer device receiving credit information exceeds 65535, it indicates a 'credit overflow' error. In case of error, the peer device receiving this event should initiate disconnection of the L2CAP channel by invoking CyBle\_L2capDisconnectReq() function. **CYBLE\_EVT\_L2CAP\_CBFC\_DATA\_WRITE\_IND** This event is used to inform application of data transmission completion over L2CAP CBFC channel. Event parameter is of type 'CYBLE\_L2CAP\_CBFC\_DATA\_WRITE\_PARAM\_T' This event will be deprecated in future. It is only kept for backward compatibility. It is not recommended to be used by new design ##Range for for future use - 0x80 to 0xFF**CYBLE\_EVT\_PENDING\_FLASH\_WRITE** This event is used to inform application that flash write is pending Stack internal data structures are modified and require backup.**CYBLE\_EVT\_LE\_PING\_AUTH\_TIMEOUT** LE PING Authentication Timeout Event to indicate that peer device has not responded with the valid MIC packet withing the application configured ping authentication time. **CYBLE\_EVT\_MAX** = 0xFF